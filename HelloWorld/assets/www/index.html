<!DOCTYPE html>

<html>
<head>
<title>My Page</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- jQuery -->
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>

<!-- jQuery UI touch punch -->
<script type="text/javascript" src="js/jquery-ui.min.js"></script>
<script type="text/javascript" src="js/jquery.ui.touch-punch.min.js"></script>

<!-- RGraph Gauge - also tried jGauge before... didn't work out... -->
<script src="js/RGraph/libraries/RGraph.common.core.js" ></script>
<script src="js/RGraph/libraries/RGraph.gauge.js" ></script>
<script type="text/javascript" src="js/RGraph/libraries/RGraph.common.dynamic.js" ></script>
<script type="text/javascript" src="js/RGraph/libraries/RGraph.common.effects.js" ></script>

<!-- jQuery Mobile -->
<link rel="stylesheet" href="js/jqm/jquery.mobile-1.3.2.css" />
<script type="text/javascript" src="js/jqm/jquery.mobile-1.3.2.js"></script>

<!-- PhoneGap -->
<script type="text/javascript" src="phonegap.js"></script>
<script type="text/javascript" src="js/bluetoothSerial.js"></script>
<script type="text/javascript" src="js/script.js"></script>

<script>
	$(document).on('pageinit', function() {
		$("#OnOffBluetooth").on("slidestop", function(event, ui) {
			console.log("initmoin");
		});
		
		$(document).delegate('#display', 'pageshow', function () {
		    //load display-page from local storage
			if(localStorage.getItem("display") != "" && localStorage.getItem("display") != null){
		    	$("#display").html(localStorage.getItem("display"));
		    }
		    
		    //adjusting page content size
			var the_height = ($(window).height() - $(this).find('[data-role="header"]').height() - $(this).find('[data-role="footer"]').height());
		    $(this).height($(window).height()).find('[data-role="content"]').height(the_height);
			
		    //drawing gauges
			var gauges=document.getElementById("displayContent").getElementsByTagName("canvas");
			for (var i = 0; i < gauges.length; i++) {
				drawGauge(gauges.item(i).id);
			}
			
			//updating gauges
			setInterval("updateGauges()", 2000);
		});

		
	});
</script>

</head>
<body onload="init();">

	<div data-role="page" id="index">

		<div data-role="header">
			<h1>Home</h1>
		</div>
		<!-- /header -->

		<div data-role="content">
			<a href="#setup" data-role="button" data-icon="gear" data-theme="b">Setup</a>
			<a href="#display" data-role="button" data-icon="star" data-theme="b">Display</a>
		</div>
		<!-- /content -->
	</div>
	<!-- /page -->


	<div data-role="page" id="setup" style="height:100%;">

		<div data-role="header">
			<a href="#index" data-role="button" data-icon="home">Home</a>
			<h1>Setup</h1>
		</div>
		<!-- /header -->

		<div data-role="content">
			<ul data-role="listview" data-inset="true">
				<li id="btConnectionStatus"> No connected Device ! </li>
			
			
				<li><input id="setBluetooth" type="button"
					value="Enable / Disable Bluetooth"
					onclick="checkIfBluetoothIsEnabled()" /></li>
				<li><input type="button" value="Find BT-Devices"
					onclick="findBTDevices()" /></li>
			</ul>

			<div data-role="popup" id="devicesPopup" data-theme="a" class="ui-corner-all">
				<div style="padding: 10px 20px;">
					<h3 id="titleDevicesPopup"></h3>
					<ul data-role="listview" id="devices" data-theme="a"></ul>
					<input type="button" value="Cancel"
					onclick="$('#devicesPopup').popup('close')" data-theme="b"/>
				</div>
			</div>
		</div>
		<!-- /content -->
	</div>
	<!-- /page -->
	
	<div data-role="page" id="display">
		<div data-role="header">
			<a href="#index" data-role="button" data-icon="home">Home</a>
			<h1>Display</h1>
			<a id="displayConf" class="ui-btn-right" data-role="button" data-icon="gear" onclick="moin()">Configure</a>
		</div>

		<div id="displayContent" data-role="content" style="padding:0px; height:100%;">
			Charts taken from <a href="http://www.rgraph.net/">RGraph</a>.
			<div id="RPMDiv" class="draggable" style="width:250px; height:250px">
				<canvas id="RPMCanvas">[No canvas support]</canvas>
			</div>
			<div id="speedDiv" class="draggable" style="width:250px; height:250px">
				<canvas id="speedCanvas">[No canvas support]</canvas>
			</div>
		</div>
	</div>


</body>
</html>
